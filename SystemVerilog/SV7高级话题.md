# SystemVerilog —— 第七章 类型转换、拷贝、回调函数和参数化的类
## 7.1 类型转换
- 静态转换
	- int'(a);
	- 在转换表达式前加上单引号，不会对转换值做检查，如果转换失败也无从得知
- 动态转换
	- $cast(tga,src);
	- 使用系统函数进行转换
	- 父类句柄转化为子类句柄时，需要使用$cast()进行转换
	- $cast()会检查句柄所指向的对象类型，而不仅仅检查句柄本身，一旦源对象跟目的句柄是同一类型的，或者是目的句柄的扩展类，即会转换成功，返回1
	- 父类句柄无法直接转换为子类句柄，父类句柄需要先指向子类的对象才能转换

## 7.2 对象拷贝
- 浅拷贝
	- p1 = new();
p2 = new()p1;
	- 在创建P2对象时，将从p1拷贝其成员变量，这种拷贝称为浅拷贝

![输入图片描述](http://www.ninglixin.com/wp-content/uploads/2022/07/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220706200316.png)

![输入图片描述](http://www.ninglixin.com/wp-content/uploads/2022/07/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220706200326.png)

- 为了保证父类的成员和子类的成员均可以完成拷贝，应将拷贝方法声明为虚方法，且遵循只拷贝该类的域成员的原则，父类的成员拷贝应由父类的拷贝方法完成
- 在实现copy_data()的过程中应注意句柄的类型转换，保证转换后的句柄可以访问类成员变量
- 将拷贝函数copy_data()和新对象生成函数copy()分为两个方法，这样使得子类的继承和方法的复用较为容易

## 7.3 回调函数
- 当我们需要修改stimulator的行为时，有两种选择
	- 修改父类，但会影响到其他继承的子类
	- 在父类定义方法时，预留回调函数入口，使得在继承的子类中填充回调函数

- 回调函数的使用方法
	- 1.预留入口
		- ![输入图片描述](http://www.ninglixin.com/wp-content/uploads/2022/07/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220706200714.png)

	- 2.定义回调函数类
		- ![输入图片描述](http://www.ninglixin.com/wp-content/uploads/2022/07/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220706200735.png)

	- 3.例化和添加回调类实例
		- ![输入图片描述](http://www.ninglixin.com/wp-content/uploads/2022/07/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220706200746.png)

## 7.4 参数化的类
- 参数化的使用是为了提高代码的复用率
- 在SV中，可以为类增加若干个数据类型参数，并在声明类句柄的时候指定类型
	- 关键词：type
- #(type T = int)
	- 将类型作为类的参数，后续可通过#()进行修改
	- ![输入图片描述](http://www.ninglixin.com/wp-content/uploads/2022/07/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220706200755.png)
